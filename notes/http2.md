## 飞机上学习的笔记

## Http2
二进制分帧与多路复用
http2是一个**彻底的**二进制协议（区别：http/1.1中，报文的头信息必须是文本(ASCII编码)，数据体可以是文本，也可以是二进制）。在http2中，头信息和数据体都是二进制协议，并且统称为“帧”。可以分为头信息帧和数据帧。帧的概念是它实现**多路复用**的基础。

#### http/1.1与http2的区别
二进制协议、多路复用、数据流、头信息压缩、服务器推送

##### 多路复用
http2实现了多路复用。http2仍然采用tcp连接。但在同一个连接里，客户端和服务器都可以**同时发送多个请求或响应**，而且**不用按照顺序**一一发送，这样就避免了队头阻塞的问题。

存在疑问：为什么有了二进制分帧就可以实现多路复用？

##### 数据流
http2采用了数据流的概念，因为http2的数据包是不按顺序发送的，同一个连接里的数据包，可能属于不同的请求，所以需要对数据包进行标记，指出它属于哪个请求。**http2将每个请求或回应的所有数据包称为一个数据流**。每个数据流都有独一无二的编号，数据包发送时都必须标记数据流id，用来区分它属于哪个数据流

##### 队头阻塞
队头阻塞是由http基本的“请求-应答”模型导致的，http规定报文必须是**“一发一收”**，这就形成了一个“先进先出”的**串行队列**。队列里的请求是**没有优先级**的，只有入队的**先后顺序**。因此，排在最前面的请求会被最优先处理，假设前面的请求消耗了太多时间，那么队列里后面的所有请求也不得不跟着一起等待。结果就是后续的请求承担了不应有的时间成本，造成队头阻塞现象。

##### 头信息压缩
http2实现了头信息压缩。由于http/1.1是**无状态**的，所以每次请求都需要带上**所有信息**。所以，请求的很多字段都是重复的，例如**Cookie和UserAgent**。一模一样的内容，每次请求都需要重复携带，会浪费很多的带宽，同时也影响速度。在http2中做了优化：1. 头信息使用gzip或compress压缩后发送；2. 客户端和服务器共同维护一张**头信息表**，所有字段都会存入这个表中，生成一个**索引号**，以后就**不需要发送同样的字段**了，**只发送索引号**，这样就可以提高速度

##### 服务器推送
http2允许服务器**未经请求**，直接向客户端发送资源。使用服务器推送可以提前向客户端推送必要的资源，这样就可以相对减少一些延迟时间。需要注意的是http2下服务器主动推送的是静态资源，与WebSocket和使用SSE等方式向客户端推送即时数据的推送是不同的。

存在疑问：
1. http2改变了基本的请求-应答模型嘛？答案：http2采用了数据流的概念，数据包不按顺序发送。
2. 自己跑个服务器看看会不会出现队头阻塞？
3. SSE是什么？了解一下实时数据推送概念及使用场景？（估计主要在直播、多端同步等场景）

注意一下队头阻塞的其他解决方案。

#### http与https的区别
https是在http与TCP的连接中增加了一层TLS/SSL层 用于对传输过程进行加密
